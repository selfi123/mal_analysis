#!/usr/bin/env python3
"""
Test Malware Sample
This is a harmless test file that contains suspicious characteristics
for testing the malware analyzer.
"""

import os
import sys
import base64
import random
import string
import time
from ctypes import windll, create_string_buffer

# Suspicious strings that will trigger YARA rules
SUSPICIOUS_STRINGS = [
    "cmd.exe",
    "powershell",
    "http://malicious.com",
    "192.168.1.1",
    "UPX",
    "CreateProcess",
    "WriteProcessMemory",
    "VirtualAlloc"
]

def generate_random_string(length):
    """Generate random string to simulate packed data"""
    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))

def main():
    print("This is a test malware sample for educational purposes only.")
    print("It does not perform any malicious actions.")
    
    # Simulate some suspicious behavior
    print("Simulating suspicious behavior...")
    time.sleep(1)
    
    # Generate some random data to simulate packed executable
    packed_data = generate_random_string(1000)
    print(f"Generated {len(packed_data)} bytes of random data")
    
    # Print some suspicious strings to trigger YARA rules
    print("\nSuspicious strings found in this sample:")
    for string in SUSPICIOUS_STRINGS:
        print(f"- {string}")
    
    # Simulate checking for debugger
    try:
        is_debugger = windll.kernel32.IsDebuggerPresent()
        print(f"\nDebugger present: {is_debugger}")
    except:
        pass
    
    print("\nTest completed successfully.")
    print("This sample is harmless and was created for testing purposes only.")

if __name__ == "__main__":
    main() 